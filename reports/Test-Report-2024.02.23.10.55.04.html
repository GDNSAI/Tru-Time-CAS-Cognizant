Here's the modified code with the requested functionality:

1. **Server-side Changes (index.js):**
```javascript
const express = require('express');
const bodyParser = require('body-parser');
const XLSX = require('xlsx');
const fs = require('fs');

const app = express();
app.use(bodyParser.urlencoded({ extended: true }));
app.use(bodyParser.json());

app.use(express.static('public'));

app.post('/submit', (req, res) => {
    const { /* all your fields */ } = req.body;

    // Validation remains the same

    const filePath = 'attendance.xlsx';
    const headers = [ /* your headers */ ];
    let data = [];

    if (fs.existsSync(filePath)) {
        const workbook = XLSX.readFile(filePath);
        const worksheet = workbook.Sheets['Sheet1']; // Changed to Sheet1
        data = XLSX.utils.sheet_to_json(worksheet);
    }

    const existingIndex = data.findIndex(row => row['Associate ID'] === associateId);
    const newRow = { /* your new row data */ };

    // Update or add row
    if (existingIndex !== -1) {
        data[existingIndex] = newRow;
    } else {
        data.push(newRow);
    }

    // Sort data - Historic first, then Current
    data.sort((a, b) => a.Status === 'Historic' ? -1 : 1);

    // Create new workbook with styles
    const workbook = XLSX.utils.book_new();
    const worksheet = XLSX.utils.json_to_sheet(data, { header: headers });

    // Add style information for Historic rows (red background)
    if (workbook.SSF) {
        const historicStyle = { fill: { bgColor: { rgb: "FFFF0000" } } };
        data.forEach((row, index) => {
            if (row.Status === 'Historic') {
                const cellAddress = XLSX.utils.encode_cell({ r: index + 1, c: 17 }); // Status column (Q)
                worksheet[cellAddress].s = historicStyle;
            }
        });
    }

    XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');
    XLSX.writeFile(workbook, filePath);

    res.json({ message: 'Data saved successfully!' });
});

// Rest of your server code remains the same
```

2. **Client-side Changes (index.html):**
```html
<script>
    // Modified Get button handler
    document.getElementById("getBtn").addEventListener("click", (event) => {
        event.preventDefault();
        const associateId = document.getElementById('associateId').value;
        
        if (!associateId) {
            alert('Please enter Associate ID');
            return;
        }

        fetch(`/fetch-data?associateId=${associateId}`)
            .then(response => {
                if (!response.ok) throw new Error('Network response was not ok');
                return response.json();
            })
            .then(data => {
                if (data.error) {
                    alert(data.error);
                } else {
                    // Populate all fields including selects
                    const selectElements = document.querySelectorAll('select');
                    selectElements.forEach(select => {
                        const value = data[select.id.replace(/([A-Z])/g, ' $1').trim()];
                        if (value) {
                            const option = Array.from(select.options).find(
                                opt => opt.value === value
                            );
                            if (option) option.selected = true;
                        }
                    });

                    const inputElements = document.querySelectorAll('input');
                    inputElements.forEach(input => {
                        const fieldName = input.id.replace(/([A-Z])/g, ' $1').trim();
                        if (data[fieldName]) {
                            input.value = data[fieldName];
                        }
                    });
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error fetching data');
            });
    });

    // Modified Submit button handler
    document.getElementById("submitBtn").addEventListener("click", async () => {
        if (validateForm()) {
            const data = collectFormData();
            try {
                const response = await fetch('/submit', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                if (response.ok) {
                    if (data.status === 'Historic') {
                        alert("Record marked as historic and moved to top!");
                    } else {
                        alert("Data saved successfully!");
                    }
                    clearForm();
                } else {
                    alert(result.error || "Failed to save data");
                }
            } catch (error) {
                console.error("Error:", error);
                alert("Failed to save data");
            }
        } else {
            alert("Please correct the highlighted fields.");
        }
    });

    // New Record button remains the same
    document.getElementById("newRecordBtn").addEventListener("click", () => {
        clearForm();
        document.getElementById('status').value = 'Current'; // Default to Current
    });

    // Rest of your client code remains the same
</script>
```

**Key Changes:**

1. **Excel Structure:**
   - Historical records now appear first in the Excel file
   - Historical records are highlighted in red (Note: XLSX style support might vary)
   - Data is stored in Sheet1 instead of Sheet2

2. **Form Handling:**
   - Get button now properly populates all form fields including select elements
   - New Record button resets the form and sets default status to "Current"
   - Submit button gives feedback about historic records

3. **Validation:**
   - Maintained existing validation but improved select element handling

4. **Sorting:**
   - Records are sorted with historical first using `data.sort((a, b) => a.Status === 'Historic' ? -1 : 1)`

**To Use:**
1. Search for a record using Associate ID with the Get button
2. Edit any fields - changing status to Historic will move it to the top
3. Use New Record button to clear the form for new entries
4. Historical records appear first in the Excel file with red highlighting

**Note:** The Excel styling might not work perfectly with the default XLSX library. For proper styling, consider using a library like `exceljs` which has better style support. Let me know if you need help implementing that!
