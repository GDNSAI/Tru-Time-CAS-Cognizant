<div class="form-container">
    <!-- Associate ID -->
    <div class="form-group">
        <label for="associateId">Associate ID:</label>
        <input type="text" id="associateId" name="associateId" placeholder="Enter Associate ID" required>
        <div class="error-message" id="associateIdError"></div>
    </div>

    <!-- Associate Name -->
    <div class="form-group">
        <label for="associateName">Associate Name:</label>
        <input type="text" id="associateName" name="associateName" placeholder="Enter Associate Name" required>
        <ul id="suggestions" class="suggestions"></ul>
        <div class="error-message" id="associateNameError"></div>
    </div>

    <!-- Status -->
    <div class="form-group">
        <label for="status">Status:</label>
        <select id="status" name="status" required>
            <option value="">Select Status</option>
            <option value="Active">Active</option>
            <option value="UBL">UBL</option>
        </select>
        <div class="error-message" id="statusError"></div>
    </div>

    <!-- Project ID -->
    <div class="form-group">
        <label for="projectId">Project ID:</label>
        <input type="text" id="projectId" name="projectId" placeholder="Enter Project ID" required>
        <div class="error-message" id="projectIdError"></div>
    </div>

    <!-- Project Name -->
    <div class="form-group">
        <label for="projectName">Project Name:</label>
        <input type="text" id="projectName" name="projectName" placeholder="Enter Project Name" required>
        <div class="error-message" id="projectNameError"></div>
    </div>

    <!-- Allocation Start Date -->
    <div class="form-group">
        <label for="allocationStartDate">Allocation Start Date:</label>
        <input type="text" id="allocationStartDate" name="allocationStartDate" placeholder="Enter Allocation Start Date" required>
        <div class="error-message" id="allocationStartDateError"></div>
    </div>

    <!-- Onshore/Offshore -->
    <div class="form-group">
        <label for="onshoreOffshore">Onshore/Offshore:</label>
        <select id="onshoreOffshore" name="onshoreOffshore" required>
            <option value="">Select Onshore/Offshore</option>
            <option value="Onshore">Onshore</option>
            <option value="Offshore">Offshore</option>
        </select>
        <div class="error-message" id="onshoreOffshoreError"></div>
    </div>

    <!-- Location -->
    <div class="form-group">
        <label for="location">Location:</label>
        <input type="text" id="location" name="location" placeholder="Enter Location" required>
        <div class="error-message" id="locationError"></div>
    </div>

    <!-- Leave Dates -->
    <div class="form-group">
        <label for="leaveDates">Leave Dates:</label>
        <input type="text" id="leaveDates" name="leaveDates" placeholder="Enter Leave Dates (comma-separated)" required>
        <div class="error-message" id="leaveDatesError"></div>
    </div>

    <!-- Leave Type -->
    <div class="form-group">
        <label for="leaveType">Leave Type:</label>
        <select id="leaveType" name="leaveType" required>
            <option value="">Select Leave Type</option>
            <option value="PL">PL</option>
            <option value="BLD">BLD</option>
        </select>
        <div class="error-message" id="leaveTypeError"></div>
    </div>
</div>

<div class="button-container">
    <button id="submitBtn">Submit</button>
</div>

const express = require('express');
const bodyParser = require('body-parser');
const XLSX = require('xlsx');
const fs = require('fs');

const app = express();
app.use(bodyParser.urlencoded({ extended: true }));

app.get('/', (req, res) => {
    res.sendFile(__dirname + '/index.html');
});

app.post('/submit', (req, res) => {
    const {
        associateId,
        associateName,
        status,
        projectId, // Make sure projectId is passed here
        projectName, // Make sure projectName is passed here
        allocationStartDate, // Ensure allocationStartDate is passed here
        onshoreOffshore,
        location,
        leaveDates,
        leaveType
    } = req.body;

    // Validation checks for required fields
    if (!associateId || !associateName || !status || !projectId || !projectName || !allocationStartDate || !onshoreOffshore || !location || !leaveDates || !leaveType) {
        return res.status(400).json({ error: 'Missing required fields' });
    }

    console.log('Form Data:', req.body); // Log the form data

    const filePath = 'C:/Users/2308397/PilotProject-Ally/attandence.xlsx';
    let workbook;
    if (fs.existsSync(filePath)) {
        workbook = XLSX.readFile(filePath);
    } else {
        workbook = XLSX.utils.book_new();
    }

    const sheetName = 'Sheet1';
    let worksheet = workbook.Sheets[sheetName];
    if (!worksheet) {
        worksheet = XLSX.utils.aoa_to_sheet([[
            'Associate ID', 'Associate Name', 'Status', 'Project ID', 'Project Name',
            'Allocation Start Date', 'Onshore/Offshore', 'Location', 'Leave Dates', 'Leave Type'
        ]]);
        XLSX.utils.book_append_sheet(workbook, worksheet, sheetName);
    }

    const newRow = [
        associateId, associateName, status, projectId, projectName,
        allocationStartDate, onshoreOffshore, location, leaveDates, leaveType
    ];
    XLSX.utils.sheet_add_aoa(worksheet, [newRow], { origin: -1 });

    XLSX.writeFile(workbook, filePath);

    console.log('Data written to Excel file'); // Log confirmation

    res.json({ message: 'Form submitted successfully!' });
});

app.listen(3000, () => {
    console.log('Server is running on port 3000');
});


